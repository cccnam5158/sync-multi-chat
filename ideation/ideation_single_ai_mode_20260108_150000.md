# Single AI Mode - ë‹¨ì¼ AI ì„œë¹„ìŠ¤ ë©€í‹° ì¸ìŠ¤í„´ìŠ¤ ê¸°ëŠ¥

## 1. Overview (ê°œìš”)

í˜„ì¬ Sync Multi Chatì€ 6ê°œì˜ AI ì„œë¹„ìŠ¤(ChatGPT, Claude, Gemini, Grok, Perplexity, Genspark) ì¤‘ ìµœëŒ€ 4ê°œë¥¼ ë™ì‹œì— ì„ íƒí•˜ì—¬ ì‚¬ìš©í•˜ëŠ” **Multi AI Mode**ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ë²ˆ ê¸°ëŠ¥ì€ í•˜ë‚˜ì˜ AI ê³µê¸‰ì‚¬ ì„œë¹„ìŠ¤ë¥¼ ìµœëŒ€ 4ê°œ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” **Single AI Mode**ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

### 1.1 ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤

> "ë‚˜ëŠ” 1ê°œì˜ AI êµ¬ë… ì„œë¹„ìŠ¤ë§Œ ì“°ëŠ”ë°... ë‹¤ë¥¸ ê±´ ë¬´ë£Œ ë²„ì „ì´ ê°€ëŠ¥í•˜ì§€ë§Œ ë‚˜ì˜ ê¸°í˜¸ì™€ëŠ” ì•ˆë§ì•„... 
> Sync Multi Chatì´ ì¢‹ì•„ë³´ì´ê¸°ëŠ” í•˜ëŠ”ë° ë‚´ê°€ ì“°ê¸°ì—” ì œì•½ì´ ìˆì–´ ë³´ì—¬... 
> ë§Œì•½ ë‚´ê°€ êµ¬ë…í•˜ëŠ” AI ì„œë¹„ìŠ¤ë¥¼ ì—¬ëŸ¬ê°œ ì—´ì–´ì„œ ì“¸ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ëŠ”ë°..."

### 1.2 í•µì‹¬ ê°€ì¹˜

- **êµ¬ë… íš¨ìœ¨ ê·¹ëŒ€í™”**: í•˜ë‚˜ì˜ ìœ ë£Œ AI ì„œë¹„ìŠ¤ë¡œ ë©€í‹° ë·° í™œìš©
- **ì‘ë‹µ ë¹„êµ**: ë™ì¼ AIì˜ ì—¬ëŸ¬ ì„¸ì…˜ì—ì„œ ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸ë¡œ ì‘ë‹µ ë¹„êµ
- **ë³‘ë ¬ ì‘ì—…**: í•˜ë‚˜ì˜ AI ì„œë¹„ìŠ¤ë¡œ ì—¬ëŸ¬ ì£¼ì œë¥¼ ë™ì‹œì— íƒìƒ‰
- **ë¬´ë£Œ ì‚¬ìš©ì ì§€ì›**: ë¬´ë£Œ ë²„ì „ AI í•˜ë‚˜ë§Œìœ¼ë¡œë„ ë©€í‹° ì±„íŒ… ê²½í—˜ ì œê³µ

---

## 2. User Requirements (ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­)

### 2.1 ëª¨ë“œ ì „í™˜ UI

#### 2.1.1 ì„¤ì • ì§„ì…ì 
- **ìœ„ì¹˜**: ì„œë¹„ìŠ¤ í† ê¸€ ë²„íŠ¼ ì˜ì—­ì˜ **ë§¨ ìš°ì¸¡**ì— ê¸°ì–´(âš™ï¸) ì•„ì´ì½˜ ë²„íŠ¼ ì¶”ê°€
- **ì•„ì´ì½˜**: Settings/Gear ì•„ì´ì½˜ (SVG)
- **ë™ì‘**: í´ë¦­ ì‹œ ëª¨ë“œ ì„¤ì • ëª¨ë‹¬ íŒì—… í‘œì‹œ

#### 2.1.2 ëª¨ë“œ ì„¤ì • ëª¨ë‹¬
- **ëª¨ë‹¬ êµ¬ì¡°**:
  - í—¤ë”: "Chat Mode Settings" + ë‹«ê¸°(Ã—) ë²„íŠ¼
  - ë³¸ë¬¸: ë‘ ê°œì˜ ëª¨ë“œ ì„ íƒ ì¹´ë“œ
  - í‘¸í„°: (ì„ íƒì ) í˜„ì¬ ì„¤ì • ìš”ì•½

- **ëª¨ë“œ ì„ íƒ ë²„íŠ¼** (ì¶”ì²œ í…ìŠ¤íŠ¸):
  | ì˜µì…˜ | ë²„íŠ¼ í…ìŠ¤íŠ¸ | ë¶€ì œëª©/ì„¤ëª… |
  |------|------------|------------|
  | 1 | **Multi AI** | Use multiple AI services together |
  | 2 | **Single AI** | Use one AI service in multiple views |

  **ëŒ€ì•ˆ í…ìŠ¤íŠ¸ í›„ë³´**:
  - "Diverse Mode" / "Focused Mode"
  - "Multi Provider" / "Single Provider"
  - "Mix & Match" / "One Service"

#### 2.1.3 Single AI Mode ìƒì„¸ UI
- ëª¨ë“œ ì„ íƒ í›„ AI ì„œë¹„ìŠ¤ ì„ íƒ ë“œë¡­ë‹¤ìš´ ë˜ëŠ” ì•„ì´ì½˜ ê·¸ë¦¬ë“œ í‘œì‹œ
- ì„ íƒ ê°€ëŠ¥ ì„œë¹„ìŠ¤: ChatGPT, Claude, Gemini, Grok, Perplexity, Genspark
- ì„ íƒ í›„ "Apply" ë²„íŠ¼ìœ¼ë¡œ ì ìš©

### 2.2 Single AI Mode ë™ì‘

#### 2.2.1 í† ê¸€ ì˜ì—­ ë³€í™”
- Multi AI Mode í† ê¸€ë“¤ ëŒ€ì‹  ì„ íƒëœ AI ì„œë¹„ìŠ¤ì˜ ì•„ì´ì½˜ê³¼ ì²´í¬ë°•ìŠ¤ê°€ **1~4ê°œ** í‘œì‹œ
- ë ˆì´ë¸” í‘œì‹œ ì˜ˆì‹œ:
  - `[âœ“] ChatGPT #1`
  - `[âœ“] ChatGPT #2`
  - `[ ] ChatGPT #3`
  - `[ ] ChatGPT #4`

#### 2.2.2 WebView ì¸ìŠ¤í„´ìŠ¤
- ì„ íƒëœ ì„œë¹„ìŠ¤ì˜ URLë¡œ 1~4ê°œì˜ ë…ë¦½ì ì¸ BrowserView ìƒì„±
- ê° ì¸ìŠ¤í„´ìŠ¤ëŠ” **ë…ë¦½ì ì¸ ì„¸ì…˜**(ì¿ í‚¤, ë¡œì»¬ ìŠ¤í† ë¦¬ì§€)ì„ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ ê³ ìœ  partition ì‚¬ìš©
  - `persist:service-chatgpt-1`, `persist:service-chatgpt-2`, etc.
- ë˜ëŠ” **ë™ì¼ ì„¸ì…˜ ê³µìœ ** ì˜µì…˜ ì œê³µ (ì„¤ì •ì—ì„œ ì„ íƒ)

#### 2.2.3 ë ˆì´ì•„ì›ƒ í˜¸í™˜ì„±
- ê¸°ì¡´ ë ˆì´ì•„ì›ƒ (1x3, 3x1, 1x4, 2x2) ëª¨ë‘ ì§€ì›
- í™œì„±í™”ëœ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ì— ë”°ë¼ ë ˆì´ì•„ì›ƒ ë²„íŠ¼ í™œì„±í™” ì¡°ê±´ ë™ì¼ ì ìš©

### 2.3 ê¸°ì¡´ ê¸°ëŠ¥ í˜¸í™˜ì„± ìš”êµ¬ì‚¬í•­

| ê¸°ëŠ¥ | í˜¸í™˜ì„± ìš”êµ¬ì‚¬í•­ |
|------|---------------|
| **ë ˆì´ì•„ì›ƒ ì„ íƒ** | 1x3, 3x1, 1x4, 2x2 ëª¨ë‘ ë™ì‘ |
| **ì„¸ì…˜ ë³µì›** | Single AI Mode ìƒíƒœ ë° ì¸ìŠ¤í„´ìŠ¤ ë³µì› |
| **ì±— íˆìŠ¤í† ë¦¬** | ê° ì¸ìŠ¤í„´ìŠ¤ë³„ URL ì €ì¥ ë° ë³µì›, **ëª¨ë“œ ì „í™˜ í¬í•¨** |
| **í”„ë¡¬í”„íŠ¸ ë™ê¸°í™”** | ëª¨ë“  í™œì„± ì¸ìŠ¤í„´ìŠ¤ì— ë™ì¼ í”„ë¡¬í”„íŠ¸ ì „ì†¡ |
| **íŒŒì¼ ì—…ë¡œë“œ ë™ê¸°í™”** | ëª¨ë“  í™œì„± ì¸ìŠ¤í„´ìŠ¤ì— íŒŒì¼ ì—…ë¡œë“œ |
| **êµì°¨ ê²€ì¦ (Cross Check)** | ì¸ìŠ¤í„´ìŠ¤ ê°„ ì‘ë‹µ ë¹„êµ ê°€ëŠ¥ |
| **ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ êµì°¨ ê²€ì¦** | ê¸°ì¡´ê³¼ ë™ì¼ |
| **ë§ˆì§€ë§‰ ì‘ë‹µ ë³µì‚¬** | ëª¨ë“  í™œì„± ì¸ìŠ¤í„´ìŠ¤ì˜ ì‘ë‹µ ë³µì‚¬ |
| **ì±— ìŠ¤ë ˆë“œ ë³µì‚¬** | ê° ì¸ìŠ¤í„´ìŠ¤ë³„ ìŠ¤ë ˆë“œ ë³µì‚¬ |
| **Anonymous Mode** | ì¸ìŠ¤í„´ìŠ¤ ì´ë¦„ì„ (A), (B), (C), (D)ë¡œ ëŒ€ì²´ |
| **Scroll Sync** | ëª¨ë“  í™œì„± ì¸ìŠ¤í„´ìŠ¤ì— ìŠ¤í¬ë¡¤ ë™ê¸°í™” |
| **WebView í—¤ë” ë²„íŠ¼** | URL ë³µì‚¬, Chromeì—ì„œ ì—´ê¸°, ìƒˆë¡œê³ ì¹¨, í™ˆ ë“± ëª¨ë‘ ë™ì‘ |
| **New Chat** | ëª¨ë“  í™œì„± ì¸ìŠ¤í„´ìŠ¤ ë¦¬ì…‹ |

### 2.4 íˆìŠ¤í† ë¦¬ ì„¸ì…˜ ë³µì› ì‹œ ëª¨ë“œ ì „í™˜

#### 2.4.1 ì‹œë‚˜ë¦¬ì˜¤ë³„ ë™ì‘

| í˜„ì¬ ëª¨ë“œ | ë³µì›í•  ì„¸ì…˜ ëª¨ë“œ | ë™ì‘ |
|----------|----------------|------|
| Multi AI | Multi AI | ì„œë¹„ìŠ¤/URL ë³µì› (ëª¨ë“œ ë³€ê²½ ì—†ìŒ) |
| Multi AI | Single AI | **Single AI Modeë¡œ ì „í™˜** + ì¸ìŠ¤í„´ìŠ¤ ë³µì› |
| Single AI | Multi AI | **Multi AI Modeë¡œ ì „í™˜** + ì„œë¹„ìŠ¤ ë³µì› |
| Single AI | Single AI (ë™ì¼ ì„œë¹„ìŠ¤) | ì¸ìŠ¤í„´ìŠ¤/URL ë³µì› (ëª¨ë“œ ë³€ê²½ ì—†ìŒ) |
| Single AI | Single AI (ë‹¤ë¥¸ ì„œë¹„ìŠ¤) | **ì„œë¹„ìŠ¤ ë³€ê²½** + ì¸ìŠ¤í„´ìŠ¤ ë³µì› |
| Any | Legacy (chatMode ì—†ìŒ) | **Multi AI Modeë¡œ ì²˜ë¦¬** |

#### 2.4.2 ë ˆê±°ì‹œ ì„¸ì…˜ í˜¸í™˜ì„±
- ê¸°ì¡´ IndexedDBì— ì €ì¥ëœ ì„¸ì…˜ ì¤‘ `chatMode` í•„ë“œê°€ ì—†ëŠ” ê²½ìš°
- í•´ë‹¹ ì„¸ì…˜ì€ **Multi AI Mode**ë¡œ ê°„ì£¼í•˜ì—¬ ë³µì›
- `activeServices` í•„ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ í™œì„±í™”

#### 2.4.3 UI í‘œì‹œ
- íˆìŠ¤í† ë¦¬ ì‚¬ì´ë“œë°”ì—ì„œ ê° ì„¸ì…˜ì˜ ëª¨ë“œë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œì‹œ
  - Multi AI ì„¸ì…˜: ê¸°ë³¸ í‘œì‹œ ë˜ëŠ” ì•„ì´ì½˜ ì—†ìŒ
  - Single AI ì„¸ì…˜: í•´ë‹¹ AI ì„œë¹„ìŠ¤ ì•„ì´ì½˜ í‘œì‹œ ë˜ëŠ” "Single" ë°°ì§€

#### 2.4.4 ëª¨ë“œ ì „í™˜ ì‹œ í™•ì¸ (ì„ íƒì )
- ëª¨ë“œê°€ ë³€ê²½ë˜ëŠ” ì„¸ì…˜ ë³µì› ì‹œ ì‚¬ìš©ì í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ ê°€ëŠ¥
- "ì´ ì„¸ì…˜ì€ Single AI Mode (ChatGPT)ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë³µì›í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
- ì„¤ì •ì—ì„œ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ ë¹„í™œì„±í™” ì˜µì…˜ ì œê³µ

---

## 3. Technical Architecture (ê¸°ìˆ  ì•„í‚¤í…ì²˜)

### 3.1 State Management (ìƒíƒœ ê´€ë¦¬)

#### 3.1.1 ìƒˆë¡œìš´ ìƒíƒœ ë³€ìˆ˜
```javascript
// renderer.js
let chatMode = 'multi'; // 'multi' | 'single'
let singleAiService = null; // 'chatgpt' | 'claude' | 'gemini' | 'grok' | 'perplexity' | 'genspark'
let singleAiInstanceCount = 4; // 1-4
let singleAiActiveInstances = [true, true, true, true]; // ê° ì¸ìŠ¤í„´ìŠ¤ í™œì„±í™” ìƒíƒœ
```

#### 3.1.2 ì„¸ì…˜ ìƒíƒœ ìŠ¤í‚¤ë§ˆ í™•ì¥
```json
{
  "version": 2,
  "chatMode": "single",
  "singleAiConfig": {
    "service": "chatgpt",
    "activeInstances": [true, true, false, false],
    "urls": {
      "chatgpt-1": "https://chatgpt.com/c/abc123",
      "chatgpt-2": "https://chatgpt.com/c/def456"
    }
  },
  "multiAiConfig": {
    "activeServices": ["chatgpt", "claude", "gemini", "perplexity"],
    "urls": { ... }
  },
  "layout": "2x2",
  "controls": {
    "anonymousMode": false,
    "scrollSync": true
  }
}
```

### 3.2 Main Process Changes (main.js)

#### 3.2.1 BrowserView ê´€ë¦¬
```javascript
// Single AI Modeìš© views
const singleModeViews = {}; // { 'chatgpt-1': view, 'chatgpt-2': view, ... }

// ê¸°ì¡´ viewsëŠ” Multi AI Modeìš©
const views = {}; // { 'chatgpt': view, 'claude': view, ... }
```

#### 3.2.2 ìƒˆë¡œìš´ IPC í•¸ë“¤ëŸ¬
```javascript
// ëª¨ë“œ ì „í™˜
ipcMain.handle('set-chat-mode', async (event, mode) => { ... });

// Single AI ì„¤ì •
ipcMain.handle('set-single-ai-config', async (event, config) => { ... });

// ì¸ìŠ¤í„´ìŠ¤ í† ê¸€
ipcMain.on('toggle-single-instance', (event, instanceIndex, enabled) => { ... });
```

#### 3.2.3 Partition ì „ëµ
```javascript
// Single AI Modeì—ì„œ ì¸ìŠ¤í„´ìŠ¤ë³„ ë…ë¦½ ì„¸ì…˜
function getSingleModePartition(service, instanceIndex, shareSession = true) {
    if (shareSession) {
        return `persist:service-${service}`; // ì„¸ì…˜ ê³µìœ 
    }
    return `persist:service-${service}-${instanceIndex}`; // ë…ë¦½ ì„¸ì…˜
}
```

### 3.3 Renderer Process Changes (renderer.js)

#### 3.3.1 í† ê¸€ ì˜ì—­ ë™ì  ë Œë”ë§
```javascript
function renderToggleArea() {
    const togglesContent = document.querySelector('.toggles-content');
    
    if (chatMode === 'multi') {
        renderMultiAiToggles(togglesContent);
    } else {
        renderSingleAiToggles(togglesContent);
    }
}

function renderSingleAiToggles(container) {
    const service = singleAiService;
    const icon = SERVICE_ICONS[service];
    const name = SERVICE_NAMES[service];
    
    // ì¸ìŠ¤í„´ìŠ¤ í† ê¸€ ìƒì„±
    for (let i = 0; i < 4; i++) {
        const label = document.createElement('label');
        label.className = 'service-toggle-label';
        label.innerHTML = `
            <input type="checkbox" id="toggle-single-${i}" ${singleAiActiveInstances[i] ? 'checked' : ''}>
            <span class="label-text">
                <span class="service-icon-wrapper">${icon}</span>
                ${isAnonymousMode ? `(${String.fromCharCode(65 + i)})` : `#${i + 1}`}
            </span>
        `;
        container.appendChild(label);
    }
}
```

#### 3.3.2 ì„¤ì • ëª¨ë‹¬ HTML ì¶”ê°€
```html
<!-- Chat Mode Settings Modal -->
<div id="chat-mode-modal" class="modal">
    <div class="modal-content chat-mode-content">
        <div class="modal-header">
            <h2>Chat Mode Settings</h2>
            <button id="close-chat-mode-btn" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
            <div class="mode-options">
                <button id="btn-multi-ai-mode" class="mode-card active">
                    <div class="mode-icon">ğŸ”€</div>
                    <h3>Multi AI</h3>
                    <p>Use multiple AI services together</p>
                </button>
                <button id="btn-single-ai-mode" class="mode-card">
                    <div class="mode-icon">ğŸ¯</div>
                    <h3>Single AI</h3>
                    <p>Use one AI service in multiple views</p>
                </button>
            </div>
            
            <!-- Single AI Service Selection (hidden by default) -->
            <div id="single-ai-selection" class="hidden">
                <h4>Select AI Service</h4>
                <div class="service-grid">
                    <!-- Service icons will be rendered here -->
                </div>
                <button id="btn-apply-single-ai" class="btn-primary">Apply</button>
            </div>
        </div>
    </div>
</div>
```

### 3.4 Prompt & File Upload í˜¸í™˜

#### 3.4.1 í”„ë¡¬í”„íŠ¸ ì „ì†¡ ìˆ˜ì •
```javascript
function sendPrompt(text, files) {
    if (chatMode === 'single') {
        const activeInstances = singleAiActiveInstances
            .map((active, i) => active ? `${singleAiService}-${i}` : null)
            .filter(Boolean);
        
        window.electronAPI.sendPromptToInstances(text, activeInstances, files);
    } else {
        const activeServices = Object.entries(toggles)
            .filter(([_, t]) => t.checked)
            .map(([k]) => k);
        
        window.electronAPI.sendPrompt(text, activeServices, files);
    }
}
```

### 3.5 Cross Check í˜¸í™˜

#### 3.5.1 ì¸ìŠ¤í„´ìŠ¤ ê°„ ì‘ë‹µ ë¹„êµ
```javascript
function buildCrossCheckPrompt() {
    if (chatMode === 'single') {
        // ë™ì¼ AIì˜ ì¸ìŠ¤í„´ìŠ¤ ì‘ë‹µ ë¹„êµ
        const responses = await getInstanceResponses();
        
        let prompt = "Below are responses from multiple instances of the same AI:\n\n";
        responses.forEach((resp, i) => {
            const label = isAnonymousMode ? `(${String.fromCharCode(65 + i)})` : `Instance #${i + 1}`;
            prompt += `### ${label}\n${resp}\n\n`;
        });
        prompt += "Please compare and analyze these responses...";
        
        return prompt;
    }
    // ê¸°ì¡´ Multi AI Mode ë¡œì§
}
```

### 3.6 íˆìŠ¤í† ë¦¬ ì„¸ì…˜ ë³µì› ì‹œ ëª¨ë“œ ì „í™˜

#### 3.6.1 ì„¸ì…˜ ë³µì› ë¡œì§
```javascript
async function restoreHistorySession(session) {
    // 1. ì„¸ì…˜ì˜ chatMode í™•ì¸ (ë ˆê±°ì‹œ ì„¸ì…˜ì€ 'multi'ë¡œ ì²˜ë¦¬)
    const sessionMode = session.chatMode || 'multi';
    
    // 2. í˜„ì¬ ëª¨ë“œì™€ ë‹¤ë¥´ë©´ ëª¨ë“œ ì „í™˜
    if (sessionMode !== chatMode) {
        await switchChatMode(sessionMode, session);
    }
    
    // 3. ëª¨ë“œì— ë”°ë¥¸ ìƒíƒœ ë³µì›
    if (sessionMode === 'single') {
        // Single AI Mode ë³µì›
        singleAiService = session.singleAiConfig.service;
        singleAiActiveInstances = session.singleAiConfig.activeInstances;
        
        // ì¸ìŠ¤í„´ìŠ¤ URL ë³µì›
        Object.entries(session.singleAiConfig.urls).forEach(([instanceKey, url]) => {
            window.electronAPI.navigateInstance(instanceKey, url);
        });
    } else {
        // Multi AI Mode ë³µì›
        const activeServices = session.activeServices || session.multiAiConfig?.activeServices;
        
        // ì„œë¹„ìŠ¤ í† ê¸€ ë° URL ë³µì›
        activeServices.forEach(service => {
            toggles[service].checked = true;
            window.electronAPI.toggleService(service, true);
        });
        
        Object.entries(session.urls || session.multiAiConfig?.urls || {}).forEach(([service, url]) => {
            window.electronAPI.navigateToUrl(service, url);
        });
    }
    
    // 4. ê³µí†µ ìƒíƒœ ë³µì› (ë ˆì´ì•„ì›ƒ, Anonymous, Scroll Sync ë“±)
    restoreCommonState(session);
}
```

#### 3.6.2 ë ˆê±°ì‹œ ì„¸ì…˜ ê°ì§€ ë° ë§ˆì´ê·¸ë ˆì´ì…˜
```javascript
function normalizeSessionData(session) {
    // chatMode í•„ë“œê°€ ì—†ëŠ” ë ˆê±°ì‹œ ì„¸ì…˜ ì²˜ë¦¬
    if (!session.chatMode) {
        return {
            ...session,
            chatMode: 'multi',
            multiAiConfig: {
                activeServices: session.activeServices || [],
                urls: session.urls || {}
            },
            singleAiConfig: null
        };
    }
    return session;
}
```

#### 3.6.3 íˆìŠ¤í† ë¦¬ ì•„ì´í…œ ëª¨ë“œ í‘œì‹œ
```javascript
function renderHistoryItem(session) {
    const modeIndicator = session.chatMode === 'single' 
        ? `<span class="mode-badge single">${SERVICE_ICONS[session.singleAiConfig.service]}</span>`
        : '';
    
    return `
        <div class="history-item" data-id="${session.id}">
            ${modeIndicator}
            <span class="history-title">${session.title}</span>
            <span class="history-date">${formatDate(session.updatedAt)}</span>
        </div>
    `;
}
```

---

## 4. UI/UX Design Details (UI/UX ìƒì„¸)

### 4.1 Settings Gear Icon

```html
<button id="chat-mode-settings-btn" class="icon-btn settings-btn" title="Chat Mode Settings">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
    </svg>
</button>
```

### 4.2 Mode Selection Cards CSS

```css
.mode-options {
    display: flex;
    gap: 16px;
    justify-content: center;
    padding: 20px 0;
}

.mode-card {
    flex: 1;
    max-width: 200px;
    padding: 24px 16px;
    border: 2px solid var(--border);
    border-radius: var(--radius);
    background: var(--background);
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
}

.mode-card:hover {
    border-color: var(--primary);
    background: var(--muted);
}

.mode-card.active {
    border-color: var(--primary);
    background: rgba(var(--primary-rgb), 0.1);
}

.mode-card .mode-icon {
    font-size: 32px;
    margin-bottom: 12px;
}

.mode-card h3 {
    margin: 0 0 8px;
    font-size: 16px;
    font-weight: 600;
}

.mode-card p {
    margin: 0;
    font-size: 12px;
    color: var(--muted-foreground);
}
```

### 4.3 Service Selection Grid

```css
.service-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;
    padding: 16px 0;
}

.service-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 16px;
    border: 2px solid var(--border);
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.2s ease;
}

.service-option:hover {
    border-color: var(--primary);
}

.service-option.selected {
    border-color: var(--primary);
    background: rgba(var(--primary-rgb), 0.1);
}

.service-option .service-icon {
    width: 32px;
    height: 32px;
    margin-bottom: 8px;
}

.service-option .service-name {
    font-size: 12px;
    font-weight: 500;
}
```

---

## 5. Implementation Plan (êµ¬í˜„ ê³„íš)

### Phase 1: Core Infrastructure (í•µì‹¬ ì¸í”„ë¼)
1. **ìƒíƒœ ê´€ë¦¬ í™•ì¥**
   - `chatMode`, `singleAiService`, `singleAiActiveInstances` ìƒíƒœ ì¶”ê°€
   - ì„¸ì…˜ ì €ì¥/ë³µì› ë¡œì§ í™•ì¥

2. **Main Process ìˆ˜ì •**
   - Single AI Modeìš© BrowserView ê´€ë¦¬ ë¡œì§
   - ìƒˆë¡œìš´ IPC í•¸ë“¤ëŸ¬ ì¶”ê°€
   - Partition ì „ëµ êµ¬í˜„

### Phase 2: UI Components (UI ì»´í¬ë„ŒíŠ¸)
3. **Settings ë²„íŠ¼ ì¶”ê°€**
   - í† ê¸€ ì˜ì—­ì— ê¸°ì–´ ì•„ì´ì½˜ ë²„íŠ¼ ì¶”ê°€
   - CSS ìŠ¤íƒ€ì¼ë§

4. **Mode Settings Modal êµ¬í˜„**
   - ëª¨ë‹¬ HTML êµ¬ì¡°
   - ëª¨ë“œ ì„ íƒ ì¹´ë“œ
   - ì„œë¹„ìŠ¤ ì„ íƒ ê·¸ë¦¬ë“œ

5. **Dynamic Toggle Rendering**
   - ëª¨ë“œì— ë”°ë¥¸ í† ê¸€ ì˜ì—­ ë™ì  ë Œë”ë§
   - Single AI Mode ì¸ìŠ¤í„´ìŠ¤ í† ê¸€

### Phase 3: Feature Integration (ê¸°ëŠ¥ í†µí•©)
6. **í”„ë¡¬í”„íŠ¸/íŒŒì¼ ì—…ë¡œë“œ í†µí•©**
   - Single AI Mode í”„ë¡¬í”„íŠ¸ ì „ì†¡ ë¡œì§
   - íŒŒì¼ ì—…ë¡œë“œ ë™ê¸°í™”

7. **Cross Check í†µí•©**
   - ì¸ìŠ¤í„´ìŠ¤ ê°„ ì‘ë‹µ ë¹„êµ ë¡œì§
   - Anonymous Mode í˜¸í™˜

8. **WebView í—¤ë” ê¸°ëŠ¥ í†µí•©**
   - URL í‘œì‹œ, ë³µì‚¬, ì™¸ë¶€ ì—´ê¸° ë“±

### Phase 4: Testing & Polish (í…ŒìŠ¤íŠ¸ ë° ë§ˆë¬´ë¦¬)
9. **í†µí•© í…ŒìŠ¤íŠ¸**
   - ëª¨ë“œ ì „í™˜ í…ŒìŠ¤íŠ¸
   - ì„¸ì…˜ ë³µì› í…ŒìŠ¤íŠ¸
   - ëª¨ë“  ê¸°ì¡´ ê¸°ëŠ¥ í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸

10. **UI ê°œì„ **
    - ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
    - ì ‘ê·¼ì„± ê°œì„ 

---

## 6. Constraints & Considerations (ì œì•½ ë° ê³ ë ¤ì‚¬í•­)

### 6.1 Technical Constraints
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: ë™ì¼ ì„œë¹„ìŠ¤ì˜ ì—¬ëŸ¬ BrowserViewëŠ” ë©”ëª¨ë¦¬ ì¦ê°€ ìœ ë°œ
- **ì„¸ì…˜ ê²©ë¦¬ vs ê³µìœ **: ë…ë¦½ ì„¸ì…˜ ì‹œ ê°ê° ë¡œê·¸ì¸ í•„ìš”, ê³µìœ  ì„¸ì…˜ ì‹œ ì¿ í‚¤ ì¶©ëŒ ê°€ëŠ¥ì„±
- **Rate Limiting**: ì¼ë¶€ AI ì„œë¹„ìŠ¤ëŠ” ë™ì‹œ ë‹¤ì¤‘ ìš”ì²­ì— ì œí•œì´ ìˆì„ ìˆ˜ ìˆìŒ

### 6.2 UX Considerations
- **ëª¨ë“œ ì „í™˜ ì‹œ ë°ì´í„° ì†ì‹¤**: ëª¨ë“œ ì „í™˜ ì‹œ í˜„ì¬ ì±„íŒ… ì»¨í…ìŠ¤íŠ¸ ë³´ì¡´ ë°©ì•ˆ í•„ìš”
- **í˜¼ë€ ë°©ì§€**: Multi/Single ëª¨ë“œ ê°„ ëª…í™•í•œ ì‹œê°ì  êµ¬ë¶„
- **ê¸°ë³¸ê°’**: ê¸°ì¡´ ì‚¬ìš©ìë¥¼ ìœ„í•´ Multi AI Modeê°€ ê¸°ë³¸ê°’

### 6.3 Backward Compatibility
- ê¸°ì¡´ ì„¸ì…˜ ë°ì´í„°ëŠ” Multi AI Modeë¡œ ê°„ì£¼
- ì´ì „ ë²„ì „ ì•±ê³¼ì˜ ì„¸ì…˜ í˜¸í™˜ì„± ìœ ì§€

---

## 7. Verification Plan (ê²€ì¦ ê³„íš)

### 7.1 Functional Testing
- [ ] Settings ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ í‘œì‹œ
- [ ] Multi AI Mode ì„ íƒ ì‹œ ê¸°ì¡´ UIë¡œ ë³µì›
- [ ] Single AI Modeì—ì„œ ì„œë¹„ìŠ¤ ì„ íƒ í›„ ì ìš© ì‹œ í† ê¸€ UI ë³€ê²½
- [ ] Single AI Modeì—ì„œ ì¸ìŠ¤í„´ìŠ¤ í† ê¸€ ON/OFF ë™ì‘
- [ ] í”„ë¡¬í”„íŠ¸ ì „ì†¡ì´ ëª¨ë“  í™œì„± ì¸ìŠ¤í„´ìŠ¤ì— ì „ë‹¬
- [ ] íŒŒì¼ ì—…ë¡œë“œê°€ ëª¨ë“  í™œì„± ì¸ìŠ¤í„´ìŠ¤ì— ì „ë‹¬
- [ ] Cross Checkì´ ì¸ìŠ¤í„´ìŠ¤ ê°„ ì‘ë‹µ ë¹„êµ ìˆ˜í–‰
- [ ] Anonymous Modeì—ì„œ ì¸ìŠ¤í„´ìŠ¤ ë ˆì´ë¸”ì´ (A), (B), (C), (D)ë¡œ í‘œì‹œ

### 7.2 Compatibility Testing
- [ ] ë ˆì´ì•„ì›ƒ ë³€ê²½ (1x3, 3x1, 1x4, 2x2) ì •ìƒ ë™ì‘
- [ ] ì„¸ì…˜ ì €ì¥ ë° ë³µì› ì •ìƒ ë™ì‘
- [ ] New Chat ë²„íŠ¼ ë™ì‘
- [ ] History ì‚¬ì´ë“œë°” ë™ì‘
- [ ] WebView í—¤ë” ë²„íŠ¼ë“¤ ë™ì‘

### 7.3 íˆìŠ¤í† ë¦¬ ì„¸ì…˜ ë³µì› í…ŒìŠ¤íŠ¸
- [ ] Multi AI Modeì—ì„œ Multi AI ì„¸ì…˜ ë³µì› ì‹œ ì •ìƒ ë™ì‘
- [ ] Multi AI Modeì—ì„œ Single AI ì„¸ì…˜ ë³µì› ì‹œ ëª¨ë“œ ì „í™˜ ë° ì¸ìŠ¤í„´ìŠ¤ ë³µì›
- [ ] Single AI Modeì—ì„œ Multi AI ì„¸ì…˜ ë³µì› ì‹œ ëª¨ë“œ ì „í™˜ ë° ì„œë¹„ìŠ¤ ë³µì›
- [ ] Single AI Modeì—ì„œ ë™ì¼ ì„œë¹„ìŠ¤ Single AI ì„¸ì…˜ ë³µì› ì‹œ ì •ìƒ ë™ì‘
- [ ] Single AI Modeì—ì„œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ Single AI ì„¸ì…˜ ë³µì› ì‹œ ì„œë¹„ìŠ¤ ë³€ê²½
- [ ] ë ˆê±°ì‹œ ì„¸ì…˜ (chatMode í•„ë“œ ì—†ìŒ) ë³µì› ì‹œ Multi AI Modeë¡œ ì²˜ë¦¬
- [ ] íˆìŠ¤í† ë¦¬ ì‚¬ì´ë“œë°”ì—ì„œ Single AI ì„¸ì…˜ì— ëª¨ë“œ í‘œì‹œ (ì•„ì´ì½˜/ë°°ì§€)
- [ ] ëª¨ë“œ ì „í™˜ ì‹œ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ (ì„¤ì •ì— ë”°ë¼)

### 7.4 Edge Cases
- [ ] Single AI Modeì—ì„œ ì¸ìŠ¤í„´ìŠ¤ 0ê°œ ì„ íƒ ì‹œ ì²˜ë¦¬
- [ ] ëª¨ë“œ ì „í™˜ ì¤‘ í”„ë¡¬í”„íŠ¸ ì „ì†¡ ì‹œ ì²˜ë¦¬
- [ ] ì•± ì¬ì‹œì‘ ì‹œ Single AI Mode ìƒíƒœ ë³µì›
- [ ] íˆìŠ¤í† ë¦¬ ì„¸ì…˜ì˜ singleAiConfig.serviceê°€ í˜„ì¬ ì§€ì›í•˜ì§€ ì•ŠëŠ” ì„œë¹„ìŠ¤ì¸ ê²½ìš° ì²˜ë¦¬
- [ ] íˆìŠ¤í† ë¦¬ ì„¸ì…˜ ë³µì› ì¤‘ ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¡¤ë°± ì²˜ë¦¬

---

## 8. Timeline (ì¼ì •)

| Phase | ê¸°ê°„ | ì„¤ëª… |
|-------|------|------|
| Phase 1 | 2ì¼ | í•µì‹¬ ì¸í”„ë¼ (ìƒíƒœ ê´€ë¦¬, Main Process) |
| Phase 2 | 2ì¼ | UI ì»´í¬ë„ŒíŠ¸ (ëª¨ë‹¬, í† ê¸€ ë Œë”ë§) |
| Phase 3 | 2ì¼ | ê¸°ëŠ¥ í†µí•© (í”„ë¡¬í”„íŠ¸, Cross Check ë“±) |
| Phase 4 | 1ì¼ | í…ŒìŠ¤íŠ¸ ë° ë§ˆë¬´ë¦¬ |
| **Total** | **7ì¼** | |

---

## 9. Future Enhancements (í–¥í›„ ê°œì„  ë°©í–¥)

1. **ì„¸ì…˜ ê³µìœ  ì˜µì…˜**: ì¸ìŠ¤í„´ìŠ¤ ê°„ ë¡œê·¸ì¸ ì„¸ì…˜ ê³µìœ  ì—¬ë¶€ ì„ íƒ
2. **ì¸ìŠ¤í„´ìŠ¤ë³„ ì»¤ìŠ¤í…€ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸**: ê° ì¸ìŠ¤í„´ìŠ¤ì— ë‹¤ë¥¸ í˜ë¥´ì†Œë‚˜ ì„¤ì •
3. **í”„ë¦¬ì…‹ ì €ì¥**: ìì£¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“œ/ì„œë¹„ìŠ¤ ì¡°í•© ì €ì¥
4. **í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ**: Single AIì™€ Multi AI í˜¼í•© ì‚¬ìš© (ì˜ˆ: ChatGPT 2ê°œ + Claude 1ê°œ)

---

## 10. Implementation Date

**ê³„íšì¼**: 2026-01-08  
**ëª©í‘œ ë²„ì „**: v0.6.0

